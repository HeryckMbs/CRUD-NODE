<main class="col-10">
  
  <div class="container">
    <h3 class="text-center">Lojas cadastradas</h3>
    <div class="panel panel-default">
      <div class="panel-heading">  
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
        Cadastrar Loja
      </button>
    </div>
      <div class="panel-body"><div class="table table-responsive">
        <table style="width: 80%;" class="table">
          <thead class="table-dark">
            <tr>
              <th>Número da Loja</th>
              <th>Rua</th>
              <th>Bairro</th>
              <th>Cidade</th>
              <th>Gerente</th>
              <th>Email do gerente</th>
              <th colspan="2">Ações</th>
            </tr>
          </thead>
          <tbody class="table-group-divider table-success table-bordered border-success">
            <% lojas.forEach(function(loja){ %>
            <tr>
              <td><%= loja.loja_id %></td>
              <td><%= loja.endereco %></td>
              <td><%= loja.bairro %></td>
              <td><%= loja.cidade %></td>
              <td><%= loja.primeiro_nome +" "+ loja.ultimo_nome %></td>
              <td><%= loja.email %></td>
      
              <td>
                <button class="btn btn-warning"><i class="fa-solid fa-pencil"></i></button>
              </td>
              <td>
                <form enctype="multipart/form-data" method="post" action="/lojadelete/<%=loja.loja_id%>">
                <button class="btn btn-danger"><i class="fa-solid fa-trash"></i></button>
              </form>
              </td>
            </tr>
            <% }) %>
      
          </tbody>
        </table>
      </div></div>
      <div class="panel-footer">Panel Footer</div>
    </div>
  </div>

  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog ">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form class="submit-form" method="POST" action="/lojas/salvar">

            <div class="row">
              <div class="col-md-12 form-group">
                <label for="rua">Rua</label>
                <input type="text" name="rua" class="form-control">
                <label for="bairro">Bairro</label>
                <input type="text" name="bairro" class="form-control">
                <label for="cep">CEP</label>
                <input type="text" name="cep" class="form-control">
                <label for="telefone">Telefone</label>
                <input type="number" name="telefone" class="form-control">
                <label for="cidade">Cidade</label>
                <select class="form-control" name="cidade">
                  <% cidades.forEach(function(cidade){ %>
                  <option value="<%=cidade.cidade_id%>"><%= cidade.cidade %></option>
                  <% }) %>

                </select>
                <label for="funcionario">Funcionário</label>
                <select class="form-control" name="funcionario">
                  <% funcionarios.forEach(function(funcionario){ %>
                  <option value="<%=funcionario.funcionario_id%>"><%= funcionario.primeiro_nome + " " + funcionario.ultimo_nome %></option>
                  <% }) %>
                </select>

              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Save changes</button>
            </div>
          </form>

        </div>
      </div>
    </div>


</main>
<% if(locals.success && success === true){ %>
<script>
  alertify.success('Loja cadastrada com sucesso!');
</script>
<% }else if(locals.success && success === false) { %>
<script>
  alertify.error('Ocorreu um erro ao cadastrar a loja!');
</script>
<% } else if(locals.success && success === 'normal'){ %>
<script>
  // alertify.alert('Ready3!');
</script>
<% } else if(locals.success && success === 'excluido'){ %>
  <script>
    alertify.success('Loja excluída com sucesso!');
  </script>
<% } %>
<% locals.success ? success = 'normal' : '' %>